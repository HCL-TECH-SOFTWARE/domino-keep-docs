<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="686px" preserveAspectRatio="none" style="width:675px;height:686px;" version="1.1" viewBox="0 0 675 686" width="675px" zoomAndPan="magnify"><defs><filter height="300%" id="f1rh7flj829csd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="303" x="184.25" y="29.4023">OAuth Flow with application server</text><rect fill="#FFFFFF" filter="url(#f1rh7flj829csd)" height="91.2422" style="stroke:#000000;stroke-width:2.0;" width="474" x="187.5" y="476.9023"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="140.1758" y2="585.1445"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="245.5" x2="245.5" y1="140.1758" y2="585.1445"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="368.5" x2="368.5" y1="140.1758" y2="585.1445"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="508.5" x2="508.5" y1="140.1758" y2="585.1445"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="617.5" x2="617.5" y1="140.1758" y2="585.1445"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="5" y="120.7344">Resource</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="14" y="137.2227">Owner</text><ellipse cx="39.5" cy="50.1992" fill="#FEFECE" filter="url(#f1rh7flj829csd)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M39.5,58.1992 L39.5,85.1992 M26.5,66.1992 L52.5,66.1992 M39.5,85.1992 L26.5,100.1992 M39.5,85.1992 L52.5,100.1992 " fill="none" filter="url(#f1rh7flj829csd)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="5" y="597.6797">Resource</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="14" y="614.168">Owner</text><ellipse cx="39.5" cy="627.1211" fill="#FEFECE" filter="url(#f1rh7flj829csd)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M39.5,635.1211 L39.5,662.1211 M26.5,643.1211 L52.5,643.1211 M39.5,662.1211 L26.5,677.1211 M39.5,662.1211 L52.5,677.1211 " fill="none" filter="url(#f1rh7flj829csd)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1rh7flj829csd)" height="46.9766" style="stroke:#A80036;stroke-width:1.5;" width="92" x="197.5" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="204.5" y="108.7344">Application</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="222" y="125.2227">Server</text><rect fill="#FEFECE" filter="url(#f1rh7flj829csd)" height="46.9766" style="stroke:#A80036;stroke-width:1.5;" width="92" x="197.5" y="584.1445"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="204.5" y="604.6797">Application</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="222" y="621.168">Server</text><rect fill="#FEFECE" filter="url(#f1rh7flj829csd)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="126" x="303.5" y="71.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="310.5" y="92.2461">Identity Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="319" y="108.7344">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="335.5" y="125.2227">Endpoint</text><rect fill="#FEFECE" filter="url(#f1rh7flj829csd)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="126" x="303.5" y="584.1445"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="310.5" y="604.6797">Identity Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="319" y="621.168">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="335.5" y="637.6563">Endpoint</text><rect fill="#FEFECE" filter="url(#f1rh7flj829csd)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="126" x="443.5" y="71.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="450.5" y="92.2461">Identity Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="485" y="108.7344">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="475.5" y="125.2227">Endpoint</text><rect fill="#FEFECE" filter="url(#f1rh7flj829csd)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="126" x="443.5" y="584.1445"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="450.5" y="604.6797">Identity Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="485" y="621.168">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="475.5" y="637.6563">Endpoint</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="585" y="120.7344">KEEP API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="583.5" y="137.2227">Endpoint</text><path d="M599.5,71.1992 C599.5,61.1992 617.5,61.1992 617.5,61.1992 C617.5,61.1992 635.5,61.1992 635.5,71.1992 L635.5,97.1992 C635.5,107.1992 617.5,107.1992 617.5,107.1992 C617.5,107.1992 599.5,107.1992 599.5,97.1992 L599.5,71.1992 " fill="#FEFECE" filter="url(#f1rh7flj829csd)" style="stroke:#000000;stroke-width:1.5;"/><path d="M599.5,71.1992 C599.5,81.1992 617.5,81.1992 617.5,81.1992 C617.5,81.1992 635.5,81.1992 635.5,71.1992 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="585" y="597.6797">KEEP API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="583.5" y="614.168">Endpoint</text><path d="M599.5,627.1211 C599.5,617.1211 617.5,617.1211 617.5,617.1211 C617.5,617.1211 635.5,617.1211 635.5,627.1211 L635.5,653.1211 C635.5,663.1211 617.5,663.1211 617.5,663.1211 C617.5,663.1211 599.5,663.1211 599.5,653.1211 L599.5,627.1211 " fill="#FEFECE" filter="url(#f1rh7flj829csd)" style="stroke:#000000;stroke-width:1.5;"/><path d="M599.5,627.1211 C599.5,637.1211 617.5,637.1211 617.5,637.1211 C617.5,637.1211 635.5,637.1211 635.5,627.1211 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#A80036" points="50.5,182.7969,40.5,186.7969,50.5,190.7969,46.5,186.7969" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="44.5" x2="244.5" y1="186.7969" y2="186.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56.5" y="174.3994">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="69.5" y="166.7441">request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="69.5" y="182.0547">authorization</text><polygon fill="#A80036" points="356.5,212.1074,366.5,216.1074,356.5,220.1074,360.5,216.1074" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39.5" x2="362.5" y1="216.1074" y2="216.1074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="46.5" y="211.3652">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="59.5" y="211.3652">access IdP</text><polygon fill="#A80036" points="50.5,241.418,40.5,245.418,50.5,249.418,46.5,245.418" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="356.5,241.418,366.5,245.418,356.5,249.418,360.5,245.418" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="362.5" y1="245.418" y2="245.418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56.5" y="240.6758">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="69.5" y="240.6758">authenticates</text><polygon fill="#A80036" points="50.5,270.7285,40.5,274.7285,50.5,278.7285,46.5,274.7285" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="356.5,270.7285,366.5,274.7285,356.5,278.7285,360.5,274.7285" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="362.5" y1="274.7285" y2="274.7285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56.5" y="269.9863">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="69.5" y="269.9863">authorizes client</text><polygon fill="#A80036" points="50.5,300.0391,40.5,304.0391,50.5,308.0391,46.5,304.0391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="44.5" x2="367.5" y1="304.0391" y2="304.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56.5" y="299.2969">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="69.5" y="299.2969">redirects with authorization code</text><polygon fill="#A80036" points="233.5,329.3496,243.5,333.3496,233.5,337.3496,237.5,333.3496" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39.5" x2="239.5" y1="333.3496" y2="333.3496"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="46.5" y="328.6074">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="59.5" y="328.6074">provide authorziation code</text><path d="M327,346.3496 L327,386.3496 L499,386.3496 L499,356.3496 L489,346.3496 L327,346.3496 " fill="#FBFB77" filter="url(#f1rh7flj829csd)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M489,346.3496 L489,356.3496 L499,356.3496 L489,346.3496 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="333" y="363.918">not suitable for browser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="333" y="379.2285">or client based access</text><polygon fill="#A80036" points="496.5,428.5918,506.5,432.5918,496.5,436.5918,500.5,432.5918" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="502.5" y1="432.5918" y2="432.5918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="252.5" y="420.1943">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="265.5" y="412.5391">send Application server credentials</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="265.5" y="427.8496">and authorization code</text><polygon fill="#A80036" points="256.5,457.9023,246.5,461.9023,256.5,465.9023,252.5,461.9023" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="507.5" y1="461.9023" y2="461.9023"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="262.5" y="457.1602">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="275.5" y="457.1602">provide access token (JWT)</text><path d="M187.5,476.9023 L308.5,476.9023 L308.5,483.9023 L298.5,493.9023 L187.5,493.9023 L187.5,476.9023 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="91.2422" style="stroke:#000000;stroke-width:2.0;" width="474" x="187.5" y="476.9023"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="76" x="202.5" y="490.4707">KEEP scope</text><polygon fill="#000000" points="605.5,526.834,615.5,530.834,605.5,534.834,609.5,530.834" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="245.5" x2="611.5" y1="530.834" y2="530.834"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="252.5" y="518.4365">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="265.5" y="510.7813">send access token (JWT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="269.5" y="526.0918">with resource request</text><polygon fill="#000000" points="256.5,556.1445,246.5,560.1445,256.5,564.1445,252.5,560.1445" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="250.5" x2="616.5" y1="560.1445" y2="560.1445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="262.5" y="555.4023">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="284.5" y="555.4023">provide resource</text><!--MD5=[26372e1649b61c70c8d96aed27229db1]
@startuml OAuth Dance
autonumber
title OAuth Flow with application server
actor       "Resource\nOwner" as human
participant "Application\nServer" as App
participant "Identity Provider\nAuthorization\nEndpoint" as IdP1
participant "Identity Provider\nToken\nEndpoint" as IdP2
database "KEEP API\nEndpoint" as keep

human <- - App: request\nauthorization
human -> IdP1: access IdP
human <-> IdP1: authenticates
human <-> IdP1: authorizes client
human <- - IdP1: redirects with authorization code
human -> App: provide authorziation code
note left of IdP2: not suitable for browser\nor client based access
App -> IdP2: send Application server credentials\nand authorization code
App <- IdP2: provide access token (JWT)
group KEEP scope
App -[#000000]> keep: send access token (JWT)\n with resource request
App <[#000000]- keep: provide resource
end
@enduml

PlantUML version 1.2021.00(Sun Jan 10 18:25:05 SGT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: SG
--></g></svg>